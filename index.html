<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Фитнес-календарь | Тренировки, питание, цели</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <style>
        :root {
            --primary-color: #4361ee;
            --primary-dark: #3a0ca3;
            --primary-light: #4cc9f0;
            --accent-color: #f72585;
            --success-color: #4ade80;
            --warning-color: #fbbf24;
            --danger-color: #ef4444;
            --food-color: #9d4edd;
            --goal-color: #ff9e00;
            --background: #121212;
            --surface: #1e1e1e;
            --surface-light: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --border-color: #333333;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            --bottom-nav-height: 60px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            padding-bottom: var(--bottom-nav-height);
        }

        .app-container {
            max-width: 100%;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo i {
            font-size: 2rem;
            color: var(--primary-color);
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .logo span {
            color: var(--primary-color);
        }

        .current-date {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Вкладки навигации */
        .tabs {
            display: flex;
            background-color: var(--surface);
            border-radius: 12px;
            margin-bottom: 25px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 500;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .tab-btn.active {
            color: var(--primary-color);
            background-color: var(--surface-light);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 20%;
            right: 20%;
            height: 3px;
            background-color: var(--primary-color);
            border-radius: 3px 3px 0 0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Календарь */
        .calendar-section {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .current-month {
            font-size: 1.2rem;
            font-weight: 500;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--surface-light);
            border: none;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .icon-btn:hover {
            background-color: var(--primary-color);
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: transparent;
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            border: none;
            padding: 0;
        }

        .calendar-day.today {
            background-color: var(--primary-color);
            color: white;
            font-weight: 500;
        }

        .calendar-day.selected {
            background-color: var(--primary-light);
            color: white;
            font-weight: 500;
        }

        .calendar-day.other-month {
            color: var(--text-secondary);
            opacity: 0.5;
        }

        .day-indicators {
            position: absolute;
            bottom: 2px;
            display: flex;
            gap: 2px;
        }

        .day-indicator {
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .indicator-workout { background-color: var(--success-color); }
        .indicator-note { background-color: var(--warning-color); }
        .indicator-measurement { background-color: var(--primary-light); }
        .indicator-food { background-color: var(--food-color); }
        .indicator-goal { background-color: var(--goal-color); }

        /* Выбранный день */
        .selected-day-card {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .selected-date {
            font-size: 1.3rem;
            font-weight: 500;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            background-color: var(--surface-light);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-value.workout { color: var(--success-color); }
        .stat-value.note { color: var(--warning-color); }
        .stat-value.measurement { color: var(--primary-light); }
        .stat-value.food { color: var(--food-color); }
        .stat-value.goal { color: var(--goal-color); }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Кнопки действий */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: var(--surface-light);
            border: none;
            border-radius: 8px;
            padding: 12px 5px;
            color: var(--text-primary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .action-btn i {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .action-btn.workout i { color: var(--success-color); }
        .action-btn.note i { color: var(--warning-color); }
        .action-btn.measurement i { color: var(--primary-light); }
        .action-btn.food i { color: var(--food-color); }
        .action-btn.goal i { color: var(--goal-color); }

        /* Контейнеры списков */
        .list-container {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .list-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .list-title i {
            color: var(--primary-color);
        }

        .items-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .item-card {
            background-color: var(--surface-light);
            border-radius: 10px;
            padding: 15px;
            transition: transform 0.2s;
        }

        .item-card:hover {
            transform: translateY(-2px);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .item-title {
            font-size: 0.95rem;
            font-weight: 500;
        }

        .item-actions {
            display: flex;
            gap: 8px;
        }

        .item-details {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: flex;
            gap: 15px;
        }

        .item-content {
            font-size: 0.9rem;
            line-height: 1.4;
        }

        /* Цели */
        .goal-progress {
            margin-top: 10px;
        }

        .progress-bar {
            height: 6px;
            background-color: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--goal-color);
            border-radius: 3px;
            transition: width 0.3s;
        }

        .goal-deadline {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .goal-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-left: 10px;
        }

        .status-active { background-color: var(--success-color); color: white; }
        .status-completed { background-color: var(--primary-color); color: white; }
        .status-failed { background-color: var(--danger-color); color: white; }

        /* Питание */
        .nutrition-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .nutrition-stat {
            background-color: var(--surface);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }

        .nutrition-value {
            font-size: 1rem;
            font-weight: 700;
            color: var(--food-color);
            margin-bottom: 3px;
        }

        .nutrition-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        /* Пустые состояния */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* Модальные окна */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            background-color: var(--surface);
            border-radius: 12px;
            padding: 25px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px;
            background-color: var(--surface-light);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: 'Roboto', sans-serif;
            transition: border-color 0.2s;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .form-checkbox input {
            width: 18px;
            height: 18px;
        }

        .modal-actions {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 12px;
            margin-top: 25px;
        }

        .btn {
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-secondary {
            background-color: var(--surface-light);
            color: var(--text-primary);
        }

        /* Нижняя навигация */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--bottom-nav-height);
            background-color: var(--surface);
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid var(--border-color);
            z-index: 100;
        }

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 0.7rem;
            cursor: pointer;
            transition: color 0.2s;
        }

        .nav-item.active {
            color: var(--primary-color);
        }

        .nav-item i {
            font-size: 1.2rem;
            margin-bottom: 4px;
        }

        /* График прогресса */
        .progress-chart {
            height: 200px;
            background-color: var(--surface);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
        }

        .chart-bar {
            flex: 1;
            background-color: var(--primary-color);
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: opacity 0.2s;
        }

        .chart-label {
            position: absolute;
            bottom: -25px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .action-buttons {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .nutrition-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .action-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <div class="logo">
                <i class="fas fa-dumbbell"></i>
                <h1>Фитнес<span>Календарь</span></h1>
            </div>
            <div class="current-date" id="currentDate"></div>
        </div>

        <!-- Вкладки навигации -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="calendar">Календарь</button>
            <button class="tab-btn" data-tab="goals">Цели</button>
            <button class="tab-btn" data-tab="nutrition">Питание</button>
            <button class="tab-btn" data-tab="progress">Прогресс</button>
        </div>

        <!-- Вкладка Календарь -->
        <div class="tab-content active" id="calendarTab">
            <div class="calendar-section">
                <div class="calendar-header">
                    <div class="current-month" id="currentMonth"></div>
                    <div class="calendar-nav">
                        <button class="icon-btn" id="prevMonth">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="icon-btn" id="todayBtn">
                            <i class="fas fa-calendar-day"></i>
                        </button>
                        <button class="icon-btn" id="nextMonth">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
                <div class="calendar-weekdays">
                    <div>Пн</div>
                    <div>Вт</div>
                    <div>Ср</div>
                    <div>Чт</div>
                    <div>Пт</div>
                    <div>Сб</div>
                    <div>Вс</div>
                </div>
                <div class="calendar-days" id="calendarDays"></div>
            </div>

            <div class="selected-day-card">
                <div class="selected-date" id="selectedDate"></div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value workout" id="workoutCount">0</div>
                        <div class="stat-label">Тренировки</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value note" id="noteCount">0</div>
                        <div class="stat-label">Заметки</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value measurement" id="measurementCount">0</div>
                        <div class="stat-label">Замеры</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value food" id="foodCount">0</div>
                        <div class="stat-label">Питание</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value goal" id="goalCount">0</div>
                        <div class="stat-label">Цели</div>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="action-btn workout" id="addWorkoutBtn">
                        <i class="fas fa-running"></i>
                        <span>Тренировка</span>
                    </button>
                    <button class="action-btn note" id="addNoteBtn">
                        <i class="fas fa-sticky-note"></i>
                        <span>Заметка</span>
                    </button>
                    <button class="action-btn measurement" id="addMeasurementBtn">
                        <i class="fas fa-weight"></i>
                        <span>Замеры</span>
                    </button>
                    <button class="action-btn food" id="addFoodBtn">
                        <i class="fas fa-utensils"></i>
                        <span>Питание</span>
                    </button>
                    <button class="action-btn goal" id="addGoalBtn">
                        <i class="fas fa-bullseye"></i>
                        <span>Цель</span>
                    </button>
                </div>
            </div>

            <div class="list-container">
                <div class="list-title">
                    <i class="fas fa-running"></i>
                    <span>Тренировки сегодня</span>
                </div>
                <div class="items-list" id="workoutsList"></div>
            </div>

            <div class="list-container">
                <div class="list-title">
                    <i class="fas fa-utensils"></i>
                    <span>Питание сегодня</span>
                </div>
                <div class="items-list" id="foodList"></div>
            </div>
        </div>

        <!-- Вкладка Цели -->
        <div class="tab-content" id="goalsTab">
            <div class="list-container">
                <div class="list-title">
                    <i class="fas fa-bullseye"></i>
                    <span>Мои цели</span>
                    <button class="icon-btn" style="margin-left: auto;" id="addNewGoalBtn">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div class="items-list" id="goalsList"></div>
            </div>

            <div class="list-container">
                <div class="list-title">
                    <i class="fas fa-chart-line"></i>
                    <span>Прогресс по целям</span>
                </div>
                <div class="progress-chart" id="goalsProgressChart"></div>
            </div>
        </div>

        <!-- Вкладка Питание -->
        <div class="tab-content" id="nutritionTab">
            <div class="list-container">
                <div class="list-title">
                    <i class="fas fa-chart-pie"></i>
                    <span>Статистика питания</span>
                </div>
                <div class="nutrition-stats" id="nutritionStats">
                    <!-- Заполнится через JavaScript -->
                </div>
            </div>

            <div class="list-container">
                <div class="list-title">
                    <i class="fas fa-calendar-alt"></i>
                    <span>История питания</span>
                </div>
                <div class="items-list" id="nutritionHistory"></div>
            </div>
        </div>

        <!-- Вкладка Прогресс -->
        <div class="tab-content" id="progressTab">
            <div class="list-container">
                <div class="list-title">
                    <i class="fas fa-weight"></i>
                    <span>Прогресс по весу</span>
                </div>
                <div class="progress-chart" id="weightChart"></div>
            </div>

            <div class="list-container">
                <div class="list-title">
                    <i class="fas fa-ruler-combined"></i>
                    <span>Прогресс по объемам</span>
                </div>
                <div class="progress-chart" id="volumeChart"></div>
            </div>
        </div>
    </div>

    <!-- Нижняя навигация -->
    <div class="bottom-nav">
        <button class="nav-item active" data-tab="calendar">
            <i class="fas fa-calendar-alt"></i>
            <span>Календарь</span>
        </button>
        <button class="nav-item" data-tab="goals">
            <i class="fas fa-bullseye"></i>
            <span>Цели</span>
        </button>
        <button class="nav-item" data-tab="nutrition">
            <i class="fas fa-utensils"></i>
            <span>Питание</span>
        </button>
        <button class="nav-item" data-tab="progress">
            <i class="fas fa-chart-line"></i>
            <span>Прогресс</span>
        </button>
    </div>

    <!-- Модальное окно тренировки -->
    <div class="modal-overlay" id="workoutModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Новая тренировка</div>
                <button class="icon-btn" id="closeWorkoutModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="workoutForm">
                <div class="form-group">
                    <label class="form-label" for="workoutType">Тип тренировки</label>
                    <select class="form-select" id="workoutType" required>
                        <option value="">Выберите тип</option>
                        <option value="strength">Силовая</option>
                        <option value="cardio">Кардио</option>
                        <option value="hiit">HIIT</option>
                        <option value="yoga">Йога/Растяжка</option>
                        <option value="crossfit">Кроссфит</option>
                        <option value="other">Другое</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="workoutDuration">Длительность (мин)</label>
                        <input class="form-input" type="number" id="workoutDuration" min="5" max="300" value="60">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="workoutIntensity">Интенсивность</label>
                        <select class="form-select" id="workoutIntensity">
                            <option value="low">Низкая</option>
                            <option value="medium" selected>Средняя</option>
                            <option value="high">Высокая</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="workoutDescription">Описание</label>
                    <textarea class="form-textarea" id="workoutDescription" rows="3" placeholder="Что делали на тренировке..."></textarea>
                </div>
            </form>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelWorkoutBtn">Отмена</button>
                <button class="btn btn-primary" id="saveWorkoutBtn">Сохранить</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно питания -->
    <div class="modal-overlay" id="foodModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Запись питания</div>
                <button class="icon-btn" id="closeFoodModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="foodForm">
                <div class="form-group">
                    <label class="form-label" for="foodType">Прием пищи</label>
                    <select class="form-select" id="foodType" required>
                        <option value="">Выберите тип</option>
                        <option value="breakfast">Завтрак</option>
                        <option value="lunch">Обед</option>
                        <option value="dinner">Ужин</option>
                        <option value="snack">Перекус</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="foodDescription">Что съели</label>
                    <textarea class="form-textarea" id="foodDescription" rows="3" placeholder="Опишите, что вы съели..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="calories">Калории (ккал)</label>
                        <input class="form-input" type="number" id="calories" min="0" max="5000" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="protein">Белки (г)</label>
                        <input class="form-input" type="number" id="protein" min="0" max="200" placeholder="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="carbs">Углеводы (г)</label>
                        <input class="form-input" type="number" id="carbs" min="0" max="200" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="fat">Жиры (г)</label>
                        <input class="form-input" type="number" id="fat" min="0" max="200" placeholder="0">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="foodNotes">Примечания</label>
                    <textarea class="form-textarea" id="foodNotes" rows="2" placeholder="Дополнительные заметки..."></textarea>
                </div>
            </form>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelFoodBtn">Отмена</button>
                <button class="btn btn-primary" id="saveFoodBtn">Сохранить</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно целей -->
    <div class="modal-overlay" id="goalModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Новая цель</div>
                <button class="icon-btn" id="closeGoalModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="goalForm">
                <div class="form-group">
                    <label class="form-label" for="goalType">Тип цели</label>
                    <select class="form-select" id="goalType" required>
                        <option value="">Выберите тип</option>
                        <option value="weight">Похудение/Набор веса</option>
                        <option value="measurement">Изменение объемов</option>
                        <option value="strength">Силовые показатели</option>
                        <option value="endurance">Выносливость</option>
                        <option value="nutrition">Питание</option>
                        <option value="other">Другое</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="goalTitle">Название цели</label>
                    <input class="form-input" type="text" id="goalTitle" placeholder="Например: Похудеть на 5 кг" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="startValue">Начальное значение</label>
                        <input class="form-input" type="number" id="startValue" step="0.1" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="targetValue">Целевое значение</label>
                        <input class="form-input" type="number" id="targetValue" step="0.1" placeholder="0" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="goalDeadline">Срок достижения</label>
                    <select class="form-select" id="goalDeadline" required>
                        <option value="">Выберите срок</option>
                        <option value="1">1 месяц</option>
                        <option value="3">3 месяца</option>
                        <option value="6">6 месяцев</option>
                        <option value="12">12 месяцев</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="goalDescription">Описание</label>
                    <textarea class="form-textarea" id="goalDescription" rows="3" placeholder="Опишите свою цель подробнее..."></textarea>
                </div>
            </form>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelGoalBtn">Отмена</button>
                <button class="btn btn-primary" id="saveGoalBtn">Сохранить цель</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно замеров (оставляем из предыдущей версии) -->
    <div class="modal-overlay" id="measurementModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Новые замеры</div>
                <button class="icon-btn" id="closeMeasurementModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <!-- Форма замеров из предыдущей версии -->
        </div>
    </div>

    <!-- Модальное окно заметок (оставляем из предыдущей версии) -->
    <div class="modal-overlay" id="noteModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Новая заметка</div>
                <button class="icon-btn" id="closeNoteModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <!-- Форма заметок из предыдущей версии -->
        </div>
    </div>

    <script>
        // Данные приложения
        let currentDate = new Date();
        let selectedDate = new Date();
        let currentTab = 'calendar';
        
        // Хранение данных
        let workouts = JSON.parse(localStorage.getItem('fitnessWorkouts')) || {};
        let notes = JSON.parse(localStorage.getItem('fitnessNotes')) || {};
        let measurements = JSON.parse(localStorage.getItem('fitnessMeasurements')) || {};
        let foods = JSON.parse(localStorage.getItem('fitnessFoods')) || {};
        let goals = JSON.parse(localStorage.getItem('fitnessGoals')) || [];

        // Инициализация приложения
        function initApp() {
            updateCurrentDate();
            renderCalendar();
            updateSelectedDayInfo();
            updateGoalsDisplay();
            updateNutritionStats();
            renderProgressCharts();
            
            setupEventListeners();
        }

        // Обновление текущей даты
        function updateCurrentDate() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ru-RU', options);
        }

        // Отрисовка календаря
        function renderCalendar() {
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';
            
            const monthNames = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 
                               'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'];
            document.getElementById('currentMonth').textContent = 
                `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
            
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            
            let firstDayIndex = firstDay.getDay();
            if (firstDayIndex === 0) firstDayIndex = 7;
            
            const prevMonthLastDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 0).getDate();
            
            // Дни предыдущего месяца
            for (let i = firstDayIndex - 1; i > 0; i--) {
                const dayNumber = prevMonthLastDay - i + 1;
                const dayDate = new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, dayNumber);
                addCalendarDay(dayDate, dayNumber, true);
            }
            
            // Дни текущего месяца
            for (let i = 1; i <= lastDay.getDate(); i++) {
                const dayDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), i);
                addCalendarDay(dayDate, i, false);
            }
            
            // Дни следующего месяца
            const totalCells = 42;
            const nextMonthDays = totalCells - (firstDayIndex - 1 + lastDay.getDate());
            
            for (let i = 1; i <= nextMonthDays; i++) {
                const dayDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, i);
                addCalendarDay(dayDate, i, true);
            }
        }

        // Добавление дня в календарь
        function addCalendarDay(date, dayNumber, isOtherMonth) {
            const dayElement = document.createElement('button');
            dayElement.className = 'calendar-day';
            
            if (isOtherMonth) {
                dayElement.classList.add('other-month');
            }
            
            // Сегодняшний день
            const today = new Date();
            if (date.getDate() === today.getDate() && 
                date.getMonth() === today.getMonth() && 
                date.getFullYear() === today.getFullYear()) {
                dayElement.classList.add('today');
            }
            
            // Выбранный день
            if (date.getDate() === selectedDate.getDate() && 
                date.getMonth() === selectedDate.getMonth() && 
                date.getFullYear() === selectedDate.getFullYear()) {
                dayElement.classList.add('selected');
            }
            
            dayElement.textContent = dayNumber;
            
            // Индикаторы событий
            const dateKey = formatDateKey(date);
            const dayWorkouts = workouts[dateKey] || [];
            const dayNotes = notes[dateKey] || [];
            const dayMeasurements = measurements[dateKey] || [];
            const dayFoods = foods[dateKey] || [];
            const activeGoals = goals.filter(g => g.status === 'active');
            
            const indicators = document.createElement('div');
            indicators.className = 'day-indicators';
            
            if (dayWorkouts.length > 0) {
                indicators.innerHTML += '<div class="day-indicator indicator-workout"></div>';
            }
            if (dayNotes.length > 0) {
                indicators.innerHTML += '<div class="day-indicator indicator-note"></div>';
            }
            if (dayMeasurements.length > 0) {
                indicators.innerHTML += '<div class="day-indicator indicator-measurement"></div>';
            }
            if (dayFoods.length > 0) {
                indicators.innerHTML += '<div class="day-indicator indicator-food"></div>';
            }
            if (activeGoals.length > 0) {
                indicators.innerHTML += '<div class="day-indicator indicator-goal"></div>';
            }
            
            if (indicators.innerHTML) {
                dayElement.appendChild(indicators);
            }
            
            // Обработчик клика
            dayElement.addEventListener('click', () => {
                selectedDate = date;
                renderCalendar();
                updateSelectedDayInfo();
            });
            
            document.getElementById('calendarDays').appendChild(dayElement);
        }

        // Обновление информации о выбранном дне
        function updateSelectedDayInfo() {
            const options = { day: 'numeric', month: 'long' };
            document.getElementById('selectedDate').textContent = selectedDate.toLocaleDateString('ru-RU', options);
            
            const dateKey = formatDateKey(selectedDate);
            const dayWorkouts = workouts[dateKey] || [];
            const dayNotes = notes[dateKey] || [];
            const dayMeasurements = measurements[dateKey] || [];
            const dayFoods = foods[dateKey] || [];
            
            document.getElementById('workoutCount').textContent = dayWorkouts.length;
            document.getElementById('noteCount').textContent = dayNotes.length;
            document.getElementById('measurementCount').textContent = dayMeasurements.length;
            document.getElementById('foodCount').textContent = dayFoods.length;
            document.getElementById('goalCount').textContent = goals.length;
            
            renderWorkoutsList(dayWorkouts);
            renderFoodList(dayFoods);
        }

        // Отрисовка списка тренировок
        function renderWorkoutsList(workoutsList) {
            const list = document.getElementById('workoutsList');
            list.innerHTML = '';
            
            if (workoutsList.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-running"></i>
                        <p>На сегодня тренировок нет</p>
                    </div>
                `;
                return;
            }
            
            workoutsList.forEach((workout, index) => {
                const workoutItem = document.createElement('div');
                workoutItem.className = 'item-card';
                
                const workoutTypeNames = {
                    'strength': 'Силовая',
                    'cardio': 'Кардио',
                    'hiit': 'HIIT',
                    'yoga': 'Йога/Растяжка',
                    'crossfit': 'Кроссфит',
                    'other': 'Другое'
                };
                
                const intensityNames = {
                    'low': 'Низкая',
                    'medium': 'Средняя',
                    'high': 'Высокая'
                };
                
                workoutItem.innerHTML = `
                    <div class="item-header">
                        <div class="item-title">${workoutTypeNames[workout.type]}</div>
                        <div class="item-actions">
                            <button class="icon-btn delete-btn" data-type="workout" data-index="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="item-details">
                        <span>${workout.duration} мин</span>
                        <span>${intensityNames[workout.intensity]}</span>
                    </div>
                    ${workout.description ? `<div class="item-content">${workout.description}</div>` : ''}
                `;
                
                list.appendChild(workoutItem);
            });
            
            // Назначение обработчиков удаления
            list.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const type = this.dataset.type;
                    const index = parseInt(this.dataset.index);
                    deleteItem(index, type);
                });
            });
        }

        // Отрисовка списка питания
        function renderFoodList(foodList) {
            const list = document.getElementById('foodList');
            list.innerHTML = '';
            
            if (foodList.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-utensils"></i>
                        <p>На сегодня записи питания нет</p>
                    </div>
                `;
                return;
            }
            
            foodList.forEach((food, index) => {
                const foodItem = document.createElement('div');
                foodItem.className = 'item-card';
                
                const foodTypeNames = {
                    'breakfast': 'Завтрак',
                    'lunch': 'Обед',
                    'dinner': 'Ужин',
                    'snack': 'Перекус'
                };
                
                let nutritionInfo = '';
                if (food.calories) {
                    nutritionInfo = `<div class="item-details">
                        <span>${food.calories} ккал</span>
                        ${food.protein ? `<span>Б: ${food.protein}г</span>` : ''}
                        ${food.carbs ? `<span>У: ${food.carbs}г</span>` : ''}
                        ${food.fat ? `<span>Ж: ${food.fat}г</span>` : ''}
                    </div>`;
                }
                
                foodItem.innerHTML = `
                    <div class="item-header">
                        <div class="item-title">${foodTypeNames[food.type]}</div>
                        <div class="item-actions">
                            <button class="icon-btn delete-btn" data-type="food" data-index="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    ${nutritionInfo}
                    <div class="item-content">${food.description}</div>
                    ${food.notes ? `<div class="item-content" style="font-size: 0.85rem; color: var(--text-secondary);">${food.notes}</div>` : ''}
                `;
                
                list.appendChild(foodItem);
            });
            
            // Назначение обработчиков удаления
            list.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const type = this.dataset.type;
                    const index = parseInt(this.dataset.index);
                    deleteItem(index, type);
                });
            });
        }

        // Отрисовка целей
        function updateGoalsDisplay() {
            const goalsList = document.getElementById('goalsList');
            goalsList.innerHTML = '';
            
            if (goals.length === 0) {
                goalsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-bullseye"></i>
                        <p>У вас пока нет целей</p>
                        <p style="margin-top: 10px;">Добавьте первую цель!</p>
                    </div>
                `;
                return;
            }
            
            goals.sort((a, b) => {
                const statusOrder = { 'active': 0, 'completed': 1, 'failed': 2 };
                return statusOrder[a.status] - statusOrder[b.status];
            });
            
            goals.forEach((goal, index) => {
                const goalItem = document.createElement('div');
                goalItem.className = 'item-card';
                
                const goalTypeNames = {
                    'weight': 'Вес',
                    'measurement': 'Объемы',
                    'strength': 'Сила',
                    'endurance': 'Выносливость',
                    'nutrition': 'Питание',
                    'other': 'Другое'
                };
                
                const statusNames = {
                    'active': 'Активна',
                    'completed': 'Достигнута',
                    'failed': 'Провалена'
                };
                
                const statusClasses = {
                    'active': 'status-active',
                    'completed': 'status-completed',
                    'failed': 'status-failed'
                };
                
                // Рассчитываем прогресс
                let progress = 0;
                let progressText = '';
                
                if (goal.startValue && goal.targetValue) {
                    progress = Math.min(100, ((goal.currentValue || goal.startValue) - goal.startValue) / 
                        (goal.targetValue - goal.startValue) * 100);
                    progressText = `${goal.currentValue || goal.startValue} → ${goal.targetValue}`;
                }
                
                // Рассчитываем оставшееся время
                const deadlineDate = new Date(goal.startDate);
                deadlineDate.setMonth(deadlineDate.getMonth() + parseInt(goal.deadline));
                const today = new Date();
                const daysRemaining = Math.ceil((deadlineDate - today) / (1000 * 60 * 60 * 24));
                
                goalItem.innerHTML = `
                    <div class="item-header">
                        <div class="item-title">${goal.title}</div>
                        <div class="item-actions">
                            <span class="goal-status ${statusClasses[goal.status]}">${statusNames[goal.status]}</span>
                            <button class="icon-btn delete-btn" data-type="goal" data-index="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="item-details">
                        <span>${goalTypeNames[goal.type]}</span>
                        <span>${progressText}</span>
                    </div>
                    <div class="item-content">${goal.description || ''}</div>
                    <div class="goal-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>
                        <div class="goal-deadline">
                            Срок: ${goal.deadline} мес. | Осталось: ${daysRemaining > 0 ? daysRemaining + ' дней' : 'срок истек'}
                        </div>
                    </div>
                `;
                
                goalsList.appendChild(goalItem);
            });
            
            renderGoalsProgressChart();
        }

        // Отрисовка графика прогресса целей
        function renderGoalsProgressChart() {
            const chart = document.getElementById('goalsProgressChart');
            chart.innerHTML = '';
            
            const activeGoals = goals.filter(g => g.status === 'active');
            
            if (activeGoals.length === 0) {
                chart.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;">
                        <div class="empty-state" style="padding: 0;">
                            <i class="fas fa-bullseye"></i>
                            <p>Нет активных целей</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            activeGoals.forEach((goal, index) => {
                let progress = 0;
                if (goal.startValue && goal.targetValue) {
                    progress = Math.min(100, ((goal.currentValue || goal.startValue) - goal.startValue) / 
                        (goal.targetValue - goal.startValue) * 100);
                }
                
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${progress}%`;
                bar.title = `${goal.title}: ${progress.toFixed(1)}%`;
                
                const label = document.createElement('div');
                label.className = 'chart-label';
                label.textContent = goal.title.substring(0, 5) + (goal.title.length > 5 ? '...' : '');
                
                bar.appendChild(label);
                chart.appendChild(bar);
            });
        }

        // Обновление статистики питания
        function updateNutritionStats() {
            const stats = document.getElementById('nutritionStats');
            stats.innerHTML = '';
            
            // Рассчитываем общую статистику за последние 7 дней
            let totalCalories = 0;
            let totalProtein = 0;
            let totalCarbs = 0;
            let totalFat = 0;
            let daysWithFood = 0;
            
            const last7Days = [];
            for (let i = 0; i < 7; i++) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                last7Days.push(formatDateKey(date));
            }
            
            last7Days.forEach(dateKey => {
                const dayFoods = foods[dateKey] || [];
                if (dayFoods.length > 0) daysWithFood++;
                
                dayFoods.forEach(food => {
                    totalCalories += parseFloat(food.calories || 0);
                    totalProtein += parseFloat(food.protein || 0);
                    totalCarbs += parseFloat(food.carbs || 0);
                    totalFat += parseFloat(food.fat || 0);
                });
            });
            
            const avgCalories = daysWithFood > 0 ? Math.round(totalCalories / daysWithFood) : 0;
            const avgProtein = daysWithFood > 0 ? Math.round(totalProtein / daysWithFood) : 0;
            const avgCarbs = daysWithFood > 0 ? Math.round(totalCarbs / daysWithFood) : 0;
            const avgFat = daysWithFood > 0 ? Math.round(totalFat / daysWithFood) : 0;
            
            stats.innerHTML = `
                <div class="nutrition-stat">
                    <div class="nutrition-value">${avgCalories}</div>
                    <div class="nutrition-label">Ккал/день</div>
                </div>
                <div class="nutrition-stat">
                    <div class="nutrition-value">${avgProtein}</div>
                    <div class="nutrition-label">Белки (г)</div>
                </div>
                <div class="nutrition-stat">
                    <div class="nutrition-value">${avgCarbs}</div>
                    <div class="nutrition-label">Углеводы (г)</div>
                </div>
                <div class="nutrition-stat">
                    <div class="nutrition-value">${avgFat}</div>
                    <div class="nutrition-label">Жиры (г)</div>
                </div>
            `;
            
            updateNutritionHistory();
        }

        // Обновление истории питания
        function updateNutritionHistory() {
            const history = document.getElementById('nutritionHistory');
            history.innerHTML = '';
            
            // Получаем последние 5 дней с записями питания
            const dates = Object.keys(foods).sort().reverse().slice(0, 5);
            
            if (dates.length === 0) {
                history.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-utensils"></i>
                        <p>Записей питания еще нет</p>
                    </div>
                `;
                return;
            }
            
            dates.forEach(dateKey => {
                const dayFoods = foods[dateKey];
                if (!dayFoods || dayFoods.length === 0) return;
                
                const date = parseDateKey(dateKey);
                const totalCalories = dayFoods.reduce((sum, food) => sum + parseFloat(food.calories || 0), 0);
                const mealCount = dayFoods.length;
                
                const historyItem = document.createElement('div');
                historyItem.className = 'item-card';
                
                historyItem.innerHTML = `
                    <div class="item-header">
                        <div class="item-title">${date.toLocaleDateString('ru-RU')}</div>
                    </div>
                    <div class="item-details">
                        <span>${mealCount} приемов пищи</span>
                        <span>${totalCalories} ккал</span>
                    </div>
                    <div class="item-content">
                        ${dayFoods.map(food => {
                            const typeNames = {
                                'breakfast': 'Завтрак',
                                'lunch': 'Обед',
                                'dinner': 'Ужин',
                                'snack': 'Перекус'
                            };
                            return `<div>${typeNames[food.type]}: ${food.description}</div>`;
                        }).join('')}
                    </div>
                `;
                
                history.appendChild(historyItem);
            });
        }

        // Отрисовка графиков прогресса
        function renderProgressCharts() {
            renderWeightChart();
            renderVolumeChart();
        }

        // График веса
        function renderWeightChart() {
            const chart = document.getElementById('weightChart');
            chart.innerHTML = '';
            
            // Собираем данные о весе из замеров
            const measurementKeys = Object.keys(measurements).sort();
            const weightData = [];
            const labels = [];
            
            measurementKeys.forEach(key => {
                const dateMeasurements = measurements[key];
                if (dateMeasurements && dateMeasurements.length > 0) {
                    const lastMeasurement = dateMeasurements[dateMeasurements.length - 1];
                    if (lastMeasurement.weight) {
                        weightData.push(lastMeasurement.weight);
                        
                        const [year, month, day] = key.split('-');
                        labels.push(`${day}.${month}`);
                    }
                }
            });
            
            if (weightData.length === 0) {
                chart.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;">
                        <div class="empty-state" style="padding: 0;">
                            <i class="fas fa-weight"></i>
                            <p>Нет данных о весе</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            const maxWeight = Math.max(...weightData);
            const minWeight = Math.min(...weightData);
            const range = maxWeight - minWeight || 1;
            
            weightData.forEach((weight, index) => {
                const barHeight = ((weight - minWeight) / range) * 80 + 20;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${barHeight}%`;
                bar.title = `${weight} кг`;
                
                const label = document.createElement('div');
                label.className = 'chart-label';
                label.textContent = labels[index];
                
                bar.appendChild(label);
                chart.appendChild(bar);
            });
        }

        // График объемов
        function renderVolumeChart() {
            const chart = document.getElementById('volumeChart');
            chart.innerHTML = '';
            
            // Собираем данные об объемах из замеров
            const measurementKeys = Object.keys(measurements).sort();
            const waistData = [];
            const labels = [];
            
            measurementKeys.forEach(key => {
                const dateMeasurements = measurements[key];
                if (dateMeasurements && dateMeasurements.length > 0) {
                    const lastMeasurement = dateMeasurements[dateMeasurements.length - 1];
                    if (lastMeasurement.waist) {
                        waistData.push(lastMeasurement.waist);
                        
                        const [year, month, day] = key.split('-');
                        labels.push(`${day}.${month}`);
                    }
                }
            });
            
            if (waistData.length === 0) {
                chart.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;">
                        <div class="empty-state" style="padding: 0;">
                            <i class="fas fa-ruler-combined"></i>
                            <p>Нет данных об объемах</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            const maxWaist = Math.max(...waistData);
            const minWaist = Math.min(...waistData);
            const range = maxWaist - minWaist || 1;
            
            waistData.forEach((waist, index) => {
                const barHeight = ((waist - minWaist) / range) * 80 + 20;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${barHeight}%`;
                bar.style.backgroundColor = '#f72585';
                bar.title = `Талия: ${waist} см`;
                
                const label = document.createElement('div');
                label.className = 'chart-label';
                label.textContent = labels[index];
                
                bar.appendChild(label);
                chart.appendChild(bar);
            });
        }

        // Добавление тренировки
        function addWorkout(workoutData) {
            const dateKey = formatDateKey(selectedDate);
            
            if (!workouts[dateKey]) {
                workouts[dateKey] = [];
            }
            
            workouts[dateKey].push(workoutData);
            localStorage.setItem('fitnessWorkouts', JSON.stringify(workouts));
            
            updateSelectedDayInfo();
            renderCalendar();
        }

        // Добавление питания
        function addFood(foodData) {
            const dateKey = formatDateKey(selectedDate);
            
            if (!foods[dateKey]) {
                foods[dateKey] = [];
            }
            
            foods[dateKey].push(foodData);
            localStorage.setItem('fitnessFoods', JSON.stringify(foods));
            
            updateSelectedDayInfo();
            renderCalendar();
            updateNutritionStats();
        }

        // Добавление цели
        function addGoal(goalData) {
            goalData.id = Date.now();
            goalData.startDate = new Date().toISOString();
            goalData.status = 'active';
            goalData.currentValue = goalData.startValue || 0;
            
            goals.push(goalData);
            localStorage.setItem('fitnessGoals', JSON.stringify(goals));
            
            updateGoalsDisplay();
            renderCalendar();
        }

        // Удаление элемента
        function deleteItem(index, type) {
            const dateKey = formatDateKey(selectedDate);
            
            switch(type) {
                case 'workout':
                    if (workouts[dateKey] && workouts[dateKey][index]) {
                        workouts[dateKey].splice(index, 1);
                        if (workouts[dateKey].length === 0) delete workouts[dateKey];
                        localStorage.setItem('fitnessWorkouts', JSON.stringify(workouts));
                        updateSelectedDayInfo();
                        renderCalendar();
                    }
                    break;
                    
                case 'food':
                    if (foods[dateKey] && foods[dateKey][index]) {
                        foods[dateKey].splice(index, 1);
                        if (foods[dateKey].length === 0) delete foods[dateKey];
                        localStorage.setItem('fitnessFoods', JSON.stringify(foods));
                        updateSelectedDayInfo();
                        renderCalendar();
                        updateNutritionStats();
                    }
                    break;
                    
                case 'goal':
                    if (goals[index]) {
                        goals.splice(index, 1);
                        localStorage.setItem('fitnessGoals', JSON.stringify(goals));
                        updateGoalsDisplay();
                        renderCalendar();
                    }
                    break;
            }
        }

        // Форматирование ключа даты
        function formatDateKey(date) {
            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
        }

        // Парсинг ключа даты
        function parseDateKey(dateKey) {
            const [year, month, day] = dateKey.split('-');
            return new Date(year, month - 1, day);
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            // Навигация по месяцам
            document.getElementById('prevMonth').addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });
            
            document.getElementById('nextMonth').addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });
            
            document.getElementById('todayBtn').addEventListener('click', () => {
                currentDate = new Date();
                selectedDate = new Date();
                renderCalendar();
                updateSelectedDayInfo();
            });
            
            // Переключение вкладок
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(`${tabId}Tab`).classList.add('active');
                    currentTab = tabId;
                });
            });
            
            // Переключение нижней навигации
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const tab = this.dataset.tab;
                    
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    const tabBtn = document.querySelector(`.tab-btn[data-tab="${tab}"]`);
                    if (tabBtn) {
                        tabBtn.classList.add('active');
                        document.getElementById(`${tab}Tab`).classList.add('active');
                        currentTab = tab;
                    }
                });
            });
            
            // Открытие модальных окон
            document.getElementById('addWorkoutBtn').addEventListener('click', () => {
                document.getElementById('workoutModal').classList.add('active');
            });
            
            document.getElementById('addFoodBtn').addEventListener('click', () => {
                document.getElementById('foodModal').classList.add('active');
            });
            
            document.getElementById('addGoalBtn').addEventListener('click', () => {
                document.getElementById('goalModal').classList.add('active');
            });
            
            document.getElementById('addNewGoalBtn').addEventListener('click', () => {
                document.getElementById('goalModal').classList.add('active');
            });
            
            // Закрытие модальных окон
            document.getElementById('closeWorkoutModal').addEventListener('click', () => {
                document.getElementById('workoutModal').classList.remove('active');
            });
            
            document.getElementById('closeFoodModal').addEventListener('click', () => {
                document.getElementById('foodModal').classList.remove('active');
            });
            
            document.getElementById('closeGoalModal').addEventListener('click', () => {
                document.getElementById('goalModal').classList.remove('active');
            });
            
            document.getElementById('cancelWorkoutBtn').addEventListener('click', () => {
                document.getElementById('workoutModal').classList.remove('active');
            });
            
            document.getElementById('cancelFoodBtn').addEventListener('click', () => {
                document.getElementById('foodModal').classList.remove('active');
            });
            
            document.getElementById('cancelGoalBtn').addEventListener('click', () => {
                document.getElementById('goalModal').classList.remove('active');
            });
            
            // Сохранение данных
            document.getElementById('saveWorkoutBtn').addEventListener('click', () => {
                const type = document.getElementById('workoutType').value;
                const duration = document.getElementById('workoutDuration').value;
                const intensity = document.getElementById('workoutIntensity').value;
                const description = document.getElementById('workoutDescription').value;
                
                if (!type) {
                    alert('Выберите тип тренировки');
                    return;
                }
                
                addWorkout({ type, duration, intensity, description });
                document.getElementById('workoutForm').reset();
                document.getElementById('workoutModal').classList.remove('active');
            });
            
            document.getElementById('saveFoodBtn').addEventListener('click', () => {
                const type = document.getElementById('foodType').value;
                const description = document.getElementById('foodDescription').value;
                const calories = document.getElementById('calories').value;
                const protein = document.getElementById('protein').value;
                const carbs = document.getElementById('carbs').value;
                const fat = document.getElementById('fat').value;
                const notes = document.getElementById('foodNotes').value;
                
                if (!type || !description) {
                    alert('Заполните обязательные поля');
                    return;
                }
                
                addFood({
                    type,
                    description,
                    calories: calories || 0,
                    protein: protein || 0,
                    carbs: carbs || 0,
                    fat: fat || 0,
                    notes
                });
                
                document.getElementById('foodForm').reset();
                document.getElementById('foodModal').classList.remove('active');
            });
            
            document.getElementById('saveGoalBtn').addEventListener('click', () => {
                const type = document.getElementById('goalType').value;
                const title = document.getElementById('goalTitle').value;
                const startValue = document.getElementById('startValue').value;
                const targetValue = document.getElementById('targetValue').value;
                const deadline = document.getElementById('goalDeadline').value;
                const description = document.getElementById('goalDescription').value;
                
                if (!type || !title || !targetValue || !deadline) {
                    alert('Заполните обязательные поля');
                    return;
                }
                
                addGoal({
                    type,
                    title,
                    startValue: startValue ? parseFloat(startValue) : 0,
                    targetValue: parseFloat(targetValue),
                    deadline,
                    description
                });
                
                document.getElementById('goalForm').reset();
                document.getElementById('goalModal').classList.remove('active');
            });
            
            // Закрытие модальных окон по клику вне
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                    }
                });
            });
        }

        // Запуск приложения
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>